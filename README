# Configuration of RaspberryPi server

Shall use of docker-compose/docker as much as possible to
* allow update of services to e.g. current PHP versions independent of host system (security!)
* allow migration by using the same software versions on different machines

Expects a /var/nextcloud directory. Subfolders might be generated by scripts?
Secrets should be in unmanaged .env files to allow putting this on github

The Raspberry makes use of two attached hard drives for file storage and backup purposes.

Contains
- nextcloud (+ mariadb, nginx, collabora, redis)
- influxdb2
- SBFSpot
- letsencrypt

TODO
- integrate smarthome stuff?


## root crontab stuff (aggregated)

15  2    * * 1 /bin/bash /home/pi/cloudy/scripts/backup.sh                            >> /home/pi/cloudy/logs/backup.log   2>&1
15  2    * * 2 /bin/bash /home/pi/cloudy/certbot/certbot.sh                           >> /home/pi/cloudy/logs/certbot.log  2>&1
15  2    * * 3 /bin/bash /home/pi/cloudy/scripts/updater.sh                           >> /home/pi/cloudy/logs/updater.log  2>&1

*/5 *    * * * docker exec -u www-data nextcloud-nextcloud php /var/www/html/cron.php >> /home/pi/cloudy/logs/cron.php.log 2>&1

*/5 6-22 * * * docker start -a sbfspot-daydata
55  05   * * * docker start -a sbfspot-monthdata


## Further services enabled on system level

- MQTT  (apt install mosquitto mosquitto-clients)
- SAMBA (apt install samba)
- NFS   (apt install nfs-kernel-server nfs-common)

## logrotate
Setup logrotate daemon to compress/remove logs if desired
